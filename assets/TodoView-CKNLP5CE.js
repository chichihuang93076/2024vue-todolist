import{u as A,r as a,i as N,h as c,c as r,a as o,t as T,w as $,v as V,n as k,F as S,j as U,o as u,k as B}from"./index-NqGV4Hll.js";const O={id:"todoListPage",class:"bg-half"},I=o("h1",null,[o("a",{href:"#"},"ONLINE TODO LIST")],-1),M={class:"todo_sm"},E={href:"#"},F={class:"conatiner todoListPage vhContainer"},P={class:"todoList_Content"},j={class:"inputBox"},R=o("i",{class:"fa fa-plus"},null,-1),W=[R],q={key:0,class:"todoList_list"},G={class:"todoList_tab"},H={class:"todoList_items"},J={class:"todoList_item"},K={class:"todoList_label"},Q=["onChange","onUpdate:modelValue"],X=["onClick"],Y=o("i",{class:"fa fa-times"},null,-1),Z=[Y],oo=o("div",{class:"todoList_statistics"},[o("p",null,"5 個已完成項目")],-1),to={key:1,className:"emptyList"},so=o("h6",{className:"emptytext"},"目前尚無待辦事項",-1),eo=o("img",{className:"emptypic",src:"https://raw.githubusercontent.com/hexschool/2022-web-layout-training/main/todolist/empty 1.png",alt:"empty1"},null,-1),ao=[so,eo],i="https://todolist-api.hexschool.io",co={__name:"TodoView",setup(no){var x;const f=A(),h=a(""),n=a(""),p=a([]),g=a([]),l=a("全部"),m=a(""),d=a("");d.value=(x=document.cookie.split("; ").find(t=>t.startsWith("hexschoolTodo=")))==null?void 0:x.split("=")[1],d.value&&(n.value=d.value),N(()=>{w(),console.log("the component is now mounted.")});const w=async()=>{const t=new Date;t.setDate(t.getDate()+1),document.cookie=`hexschoolTodo=${n.value}; expires=${t.toUTCString()}`;try{const s=await c.get(`${i}/users/checkout`,{headers:{Authorization:d.value}});m.value=s.data.nickname,v(),console.log("驗證成功 UID: "+s.data.uid)}catch(s){console.log("驗證失敗: "+s.message),f.push("/")}},C=async()=>{try{(await c.post(`${i}/users/sign_out`,{},{headers:{Authorization:d.value}})).data.status&&(document.cookie="hexschoolTodo=",m.value="",f.push("/"))}catch(t){console.log("登出失敗"),alert("登出失敗",t.response.data.message)}},_=t=>{var s;l.value=t,console.log(l.value),g.value=(s=p.value)==null?void 0:s.filter(e=>t==="待完成"?!e.status:t==="已完成"?e.status:e),console.log(g.value)},L=async t=>{try{const s=await c.patch(`${i}/todos/${t}/toggle`,{},{headers:{Authorization:n.value}});console.log(s.data.status),v()}catch(s){alert("toggle失敗",s.response.data.message)}},b=async()=>{try{const t={content:h.value},s=c.post(`${i}/todos/`,t,{headers:{Authorization:n.value}});console.log("資料新增成功:",s.data),h.value="",alert("資料新增成功"),v()}catch(t){console.error("新增資料時發生錯誤:",t),alert("新增資料時發生錯誤"+t.response.data.message)}},z=async t=>{console.log(t);try{const s=await c.delete(`${i}/todos/${t}`,{headers:{Authorization:n.value}});console.log(s)}catch(s){console.log(s.response.data.message)}},D=t=>{z(t),v()},v=async()=>{try{const t=await c.get(`${i}/todos/`,{headers:{Authorization:n.value}});p.value=t.data.data,_(l.value)}catch(t){console.error("資料取得發生錯誤:",t),alert("資料取得發生錯誤"+t.response.data.message)}};return(t,s)=>(u(),r("div",O,[o("nav",null,[I,o("ul",null,[o("li",M,[o("a",E,[o("span",null,T(m.value)+"的代辦",1)])]),o("li",null,[o("a",{onClick:C},"登出")])])]),o("div",F,[o("div",P,[o("div",j,[$(o("input",{type:"text",placeholder:"請輸入待辦事項","onUpdate:modelValue":s[0]||(s[0]=e=>h.value=e)},null,512),[[V,h.value]]),o("a",{onClick:b},W)]),p.value.length>0?(u(),r("div",q,[o("ul",G,[o("li",null,[o("a",{class:k({active:l.value==="全部"}),name:"全部",onClick:s[1]||(s[1]=e=>_("全部"))},"全部",2)]),o("li",null,[o("a",{class:k({active:l.value==="待完成"}),name:"待完成",onClick:s[2]||(s[2]=e=>_("待完成"))},"待完成",2)]),o("li",null,[o("a",{class:k({active:l.value==="已完成"}),name:"已完成",onClick:s[3]||(s[3]=e=>_("已完成"))},"已完成",2)])]),o("div",H,[o("ul",J,[(u(!0),r(S,null,U(g.value,e=>(u(),r("li",{key:e.id},[o("label",K,[$(o("input",{class:"todoList_input",type:"checkbox",value:"true",onChange:y=>L(e.id),"onUpdate:modelValue":y=>e.status=y},null,40,Q),[[B,e.status]]),o("span",null,T(e.content),1)]),o("a",{onClick:y=>D(e.id)},Z,8,X)]))),128))]),oo])])):(u(),r("div",to,ao))])])]))}};export{co as default};
