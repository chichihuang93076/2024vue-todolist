import{u as N,r as a,j as S,i as c,k as V,c as u,a as t,t as k,w as C,v as U,n as f,F as O,l as P,h as T,o as d,m as I}from"./index-C1GaMvhf.js";const M={id:"todoListPage",class:"bg-half"},E=t("h1",null,[t("a",{href:"#"},"ONLINE TODO LIST")],-1),F={class:"todo_sm"},j={href:"#"},R={class:"conatiner todoListPage vhContainer"},W={class:"todoList_Content"},q={class:"inputBox"},G=t("i",{class:"fa fa-plus"},null,-1),H=[G],J={key:0,class:"todoList_list"},K={class:"todoList_tab"},Q={class:"todoList_items"},X={class:"todoList_item"},Y={class:"todoList_label"},Z=["onChange","onUpdate:modelValue"],tt=["onClick"],ot=t("i",{class:"fa fa-times"},null,-1),st=[ot],et={class:"todoList_statistics"},at={key:1,className:"emptyList"},nt=t("h6",{className:"emptytext"},"目前尚無待辦事項",-1),lt=t("img",{className:"emptypic",src:"https://raw.githubusercontent.com/hexschool/2022-web-layout-training/main/todolist/empty 1.png",alt:"empty1"},null,-1),ct=[nt,lt],i="https://todolist-api.hexschool.io",ut={__name:"TodoView",setup(it){var w;const x=N(),h=a(""),n=a(""),_=a([]),g=a([]),l=a("全部"),m=a(""),r=a("");r.value=(w=document.cookie.split("; ").find(o=>o.startsWith("hexschoolTodo=")))==null?void 0:w.split("=")[1],r.value&&(n.value=r.value),S(()=>{$(),console.log("the component is now mounted.")});const $=async()=>{const o=new Date;o.setDate(o.getDate()+1),document.cookie=`hexschoolTodo=${n.value}; expires=${o.toUTCString()}`;try{const s=await c.get(`${i}/users/checkout`,{headers:{Authorization:r.value}});m.value=s.data.nickname,p(),console.log("驗證成功 UID: "+s.data.uid)}catch(s){console.log("驗證失敗: "+s.message),x.push("/")}},L=async()=>{try{(await c.post(`${i}/users/sign_out`,{},{headers:{Authorization:r.value}})).data.status&&(document.cookie="hexschoolTodo=",m.value="",x.push("/"))}catch(o){console.log("登出失敗"),alert("登出失敗",o.response.data.message)}},v=o=>{var s;l.value=o,console.log(l.value),g.value=(s=_.value)==null?void 0:s.filter(e=>o==="待完成"?!e.status:o==="已完成"?e.status:e),console.log(g.value)},b=async o=>{try{const s=await c.patch(`${i}/todos/${o}/toggle`,{},{headers:{Authorization:n.value}});console.log(s.data.status),p()}catch(s){alert("toggle失敗",s.response.data.message)}},z=async()=>{try{const o={content:h.value},s=c.post(`${i}/todos/`,o,{headers:{Authorization:n.value}});console.log("資料新增成功:",s.data),h.value="",T.fire({icon:"success",title:"訊息",text:"資料新增成功",timer:2e3,timerProgressBar:!0}),p()}catch(o){console.error("新增資料時發生錯誤:",o),T.fire({icon:"error",title:"訊息",text:"新增資料時發生錯誤"+o.response.data.message,timer:2e3,timerProgressBar:!0})}},D=async o=>{console.log(o);try{const s=await c.delete(`${i}/todos/${o}`,{headers:{Authorization:n.value}});console.log(s)}catch(s){console.log(s.response.data.message)}},A=o=>{D(o),p()},p=async()=>{try{const o=await c.get(`${i}/todos/`,{headers:{Authorization:n.value}});_.value=o.data.data,v(l.value)}catch(o){console.error("資料取得發生錯誤:",o),alert("資料取得發生錯誤"+o.response.data.message)}},B=V(()=>_.value.filter(o=>!o.status).length);return(o,s)=>(d(),u("div",M,[t("nav",null,[E,t("ul",null,[t("li",F,[t("a",j,[t("span",null,k(m.value)+"的代辦",1)])]),t("li",null,[t("a",{onClick:L},"登出")])])]),t("div",R,[t("div",W,[t("div",q,[C(t("input",{type:"text",placeholder:"請輸入待辦事項","onUpdate:modelValue":s[0]||(s[0]=e=>h.value=e)},null,512),[[U,h.value]]),t("a",{onClick:z},H)]),_.value.length>0?(d(),u("div",J,[t("ul",K,[t("li",null,[t("a",{class:f({active:l.value==="全部"}),name:"全部",onClick:s[1]||(s[1]=e=>v("全部"))},"全部",2)]),t("li",null,[t("a",{class:f({active:l.value==="待完成"}),name:"待完成",onClick:s[2]||(s[2]=e=>v("待完成"))},"待完成",2)]),t("li",null,[t("a",{class:f({active:l.value==="已完成"}),name:"已完成",onClick:s[3]||(s[3]=e=>v("已完成"))},"已完成",2)])]),t("div",Q,[t("ul",X,[(d(!0),u(O,null,P(g.value,e=>(d(),u("li",{key:e.id},[t("label",Y,[C(t("input",{class:"todoList_input",type:"checkbox",value:"true",onChange:y=>b(e.id),"onUpdate:modelValue":y=>e.status=y},null,40,Z),[[I,e.status]]),t("span",null,k(e.content),1)]),t("a",{onClick:y=>A(e.id)},st,8,tt)]))),128))]),t("div",et,[t("p",null,k(B.value)+" 個未完成項目",1)])])])):(d(),u("div",at,ct))])])]))}};export{ut as default};
